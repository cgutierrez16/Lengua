{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Mutex = void 0;\n/**\n * @license\n * Copyright 2024 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nconst Deferred_js_1 = require(\"./Deferred.js\");\nconst disposable_js_1 = require(\"./disposable.js\");\n/**\n * @internal\n */\nclass Mutex {\n  static Guard = class Guard {\n    #mutex;\n    constructor(mutex) {\n      this.#mutex = mutex;\n    }\n    [disposable_js_1.disposeSymbol]() {\n      return this.#mutex.release();\n    }\n  };\n  #locked = false;\n  #acquirers = [];\n  // This is FIFO.\n  async acquire() {\n    if (!this.#locked) {\n      this.#locked = true;\n      return new Mutex.Guard(this);\n    }\n    const deferred = Deferred_js_1.Deferred.create();\n    this.#acquirers.push(deferred.resolve.bind(deferred));\n    await deferred.valueOrThrow();\n    return new Mutex.Guard(this);\n  }\n  release() {\n    const resolve = this.#acquirers.shift();\n    if (!resolve) {\n      this.#locked = false;\n      return;\n    }\n    resolve();\n  }\n}\nexports.Mutex = Mutex;","map":{"version":3,"names":["Deferred_js_1","require","disposable_js_1","Mutex","Guard","mutex","constructor","disposeSymbol","release","locked","acquirers","acquire","deferred","Deferred","create","push","resolve","bind","valueOrThrow","shift","exports"],"sources":["/Users/carlosgutierrez/Documents/React/spanish/node_modules/puppeteer-core/src/util/Mutex.ts"],"sourcesContent":["/**\n * @license\n * Copyright 2024 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nimport {Deferred} from './Deferred.js';\nimport {disposeSymbol} from './disposable.js';\n\n/**\n * @internal\n */\nexport class Mutex {\n  static Guard = class Guard {\n    #mutex: Mutex;\n    constructor(mutex: Mutex) {\n      this.#mutex = mutex;\n    }\n    [disposeSymbol](): void {\n      return this.#mutex.release();\n    }\n  };\n\n  #locked = false;\n  #acquirers: Array<() => void> = [];\n\n  // This is FIFO.\n  async acquire(): Promise<InstanceType<typeof Mutex.Guard>> {\n    if (!this.#locked) {\n      this.#locked = true;\n      return new Mutex.Guard(this);\n    }\n    const deferred = Deferred.create<void>();\n    this.#acquirers.push(deferred.resolve.bind(deferred));\n    await deferred.valueOrThrow();\n    return new Mutex.Guard(this);\n  }\n\n  release(): void {\n    const resolve = this.#acquirers.shift();\n    if (!resolve) {\n      this.#locked = false;\n      return;\n    }\n    resolve();\n  }\n}\n"],"mappings":";;;;;;AAAA;;;;;AAKA,MAAAA,aAAA,GAAAC,OAAA;AACA,MAAAC,eAAA,GAAAD,OAAA;AAEA;;;AAGA,MAAaE,KAAK;EAChB,OAAOC,KAAK,GAAG,MAAMA,KAAK;IACxB,CAAAC,KAAM;IACNC,YAAYD,KAAY;MACtB,IAAI,CAAC,CAAAA,KAAM,GAAGA,KAAK;IACrB;IACA,CAACH,eAAA,CAAAK,aAAa,IAAC;MACb,OAAO,IAAI,CAAC,CAAAF,KAAM,CAACG,OAAO,EAAE;IAC9B;GACD;EAED,CAAAC,MAAO,GAAG,KAAK;EACf,CAAAC,SAAU,GAAsB,EAAE;EAElC;EACA,MAAMC,OAAOA,CAAA;IACX,IAAI,CAAC,IAAI,CAAC,CAAAF,MAAO,EAAE;MACjB,IAAI,CAAC,CAAAA,MAAO,GAAG,IAAI;MACnB,OAAO,IAAIN,KAAK,CAACC,KAAK,CAAC,IAAI,CAAC;IAC9B;IACA,MAAMQ,QAAQ,GAAGZ,aAAA,CAAAa,QAAQ,CAACC,MAAM,EAAQ;IACxC,IAAI,CAAC,CAAAJ,SAAU,CAACK,IAAI,CAACH,QAAQ,CAACI,OAAO,CAACC,IAAI,CAACL,QAAQ,CAAC,CAAC;IACrD,MAAMA,QAAQ,CAACM,YAAY,EAAE;IAC7B,OAAO,IAAIf,KAAK,CAACC,KAAK,CAAC,IAAI,CAAC;EAC9B;EAEAI,OAAOA,CAAA;IACL,MAAMQ,OAAO,GAAG,IAAI,CAAC,CAAAN,SAAU,CAACS,KAAK,EAAE;IACvC,IAAI,CAACH,OAAO,EAAE;MACZ,IAAI,CAAC,CAAAP,MAAO,GAAG,KAAK;MACpB;IACF;IACAO,OAAO,EAAE;EACX;;AAjCFI,OAAA,CAAAjB,KAAA,GAAAA,KAAA","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}