{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function () {\n        return m[k];\n      }\n    };\n  }\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ProductLauncher = void 0;\n/**\n * @license\n * Copyright 2017 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nconst fs_1 = require(\"fs\");\nconst os_1 = require(\"os\");\nconst path_1 = require(\"path\");\nconst browsers_1 = require(\"@puppeteer/browsers\");\nconst rxjs_js_1 = require(\"../../third_party/rxjs/rxjs.js\");\nconst Browser_js_1 = require(\"../cdp/Browser.js\");\nconst Connection_js_1 = require(\"../cdp/Connection.js\");\nconst Errors_js_1 = require(\"../common/Errors.js\");\nconst util_js_1 = require(\"../common/util.js\");\nconst NodeWebSocketTransport_js_1 = require(\"./NodeWebSocketTransport.js\");\nconst PipeTransport_js_1 = require(\"./PipeTransport.js\");\n/**\n * Describes a launcher - a class that is able to create and launch a browser instance.\n *\n * @public\n */\nclass ProductLauncher {\n  #product;\n  /**\n   * @internal\n   */\n  puppeteer;\n  /**\n   * @internal\n   */\n  actualBrowserRevision;\n  /**\n   * @internal\n   */\n  constructor(puppeteer, product) {\n    this.puppeteer = puppeteer;\n    this.#product = product;\n  }\n  get product() {\n    return this.#product;\n  }\n  async launch(options = {}) {\n    const {\n      dumpio = false,\n      env = process.env,\n      handleSIGINT = true,\n      handleSIGTERM = true,\n      handleSIGHUP = true,\n      ignoreHTTPSErrors = false,\n      defaultViewport = util_js_1.DEFAULT_VIEWPORT,\n      slowMo = 0,\n      timeout = 30000,\n      waitForInitialPage = true,\n      protocolTimeout,\n      protocol\n    } = options;\n    const launchArgs = await this.computeLaunchArguments(options);\n    if (!(0, fs_1.existsSync)(launchArgs.executablePath)) {\n      throw new Error(`Browser was not found at the configured executablePath (${launchArgs.executablePath})`);\n    }\n    const usePipe = launchArgs.args.includes('--remote-debugging-pipe');\n    const onProcessExit = async () => {\n      await this.cleanUserDataDir(launchArgs.userDataDir, {\n        isTemp: launchArgs.isTempUserDataDir\n      });\n    };\n    const browserProcess = (0, browsers_1.launch)({\n      executablePath: launchArgs.executablePath,\n      args: launchArgs.args,\n      handleSIGHUP,\n      handleSIGTERM,\n      handleSIGINT,\n      dumpio,\n      env,\n      pipe: usePipe,\n      onExit: onProcessExit\n    });\n    let browser;\n    let cdpConnection;\n    let closing = false;\n    const browserCloseCallback = async () => {\n      if (closing) {\n        return;\n      }\n      closing = true;\n      await this.closeBrowser(browserProcess, cdpConnection);\n    };\n    try {\n      if (this.#product === 'firefox' && protocol === 'webDriverBiDi') {\n        browser = await this.createBiDiBrowser(browserProcess, browserCloseCallback, {\n          timeout,\n          protocolTimeout,\n          slowMo,\n          defaultViewport,\n          ignoreHTTPSErrors\n        });\n      } else {\n        if (usePipe) {\n          cdpConnection = await this.createCdpPipeConnection(browserProcess, {\n            timeout,\n            protocolTimeout,\n            slowMo\n          });\n        } else {\n          cdpConnection = await this.createCdpSocketConnection(browserProcess, {\n            timeout,\n            protocolTimeout,\n            slowMo\n          });\n        }\n        if (protocol === 'webDriverBiDi') {\n          browser = await this.createBiDiOverCdpBrowser(browserProcess, cdpConnection, browserCloseCallback, {\n            timeout,\n            protocolTimeout,\n            slowMo,\n            defaultViewport,\n            ignoreHTTPSErrors\n          });\n        } else {\n          browser = await Browser_js_1.CdpBrowser._create(this.product, cdpConnection, [], ignoreHTTPSErrors, defaultViewport, browserProcess.nodeProcess, browserCloseCallback, options.targetFilter);\n        }\n      }\n    } catch (error) {\n      void browserCloseCallback();\n      if (error instanceof browsers_1.TimeoutError) {\n        throw new Errors_js_1.TimeoutError(error.message);\n      }\n      throw error;\n    }\n    if (waitForInitialPage && protocol !== 'webDriverBiDi') {\n      await this.waitForPageTarget(browser, timeout);\n    }\n    return browser;\n  }\n  /**\n   * Set only for Firefox, after the launcher resolves the `latest` revision to\n   * the actual revision.\n   * @internal\n   */\n  getActualBrowserRevision() {\n    return this.actualBrowserRevision;\n  }\n  /**\n   * @internal\n   */\n  async closeBrowser(browserProcess, cdpConnection) {\n    if (cdpConnection) {\n      // Attempt to close the browser gracefully\n      try {\n        await cdpConnection.closeBrowser();\n        await browserProcess.hasClosed();\n      } catch (error) {\n        (0, util_js_1.debugError)(error);\n        await browserProcess.close();\n      }\n    } else {\n      // Wait for a possible graceful shutdown.\n      await (0, rxjs_js_1.firstValueFrom)((0, rxjs_js_1.race)((0, rxjs_js_1.from)(browserProcess.hasClosed()), (0, rxjs_js_1.timer)(5000).pipe((0, rxjs_js_1.map)(() => {\n        return (0, rxjs_js_1.from)(browserProcess.close());\n      }))));\n    }\n  }\n  /**\n   * @internal\n   */\n  async waitForPageTarget(browser, timeout) {\n    try {\n      await browser.waitForTarget(t => {\n        return t.type() === 'page';\n      }, {\n        timeout\n      });\n    } catch (error) {\n      await browser.close();\n      throw error;\n    }\n  }\n  /**\n   * @internal\n   */\n  async createCdpSocketConnection(browserProcess, opts) {\n    const browserWSEndpoint = await browserProcess.waitForLineOutput(browsers_1.CDP_WEBSOCKET_ENDPOINT_REGEX, opts.timeout);\n    const transport = await NodeWebSocketTransport_js_1.NodeWebSocketTransport.create(browserWSEndpoint);\n    return new Connection_js_1.Connection(browserWSEndpoint, transport, opts.slowMo, opts.protocolTimeout);\n  }\n  /**\n   * @internal\n   */\n  async createCdpPipeConnection(browserProcess, opts) {\n    // stdio was assigned during start(), and the 'pipe' option there adds the\n    // 4th and 5th items to stdio array\n    const {\n      3: pipeWrite,\n      4: pipeRead\n    } = browserProcess.nodeProcess.stdio;\n    const transport = new PipeTransport_js_1.PipeTransport(pipeWrite, pipeRead);\n    return new Connection_js_1.Connection('', transport, opts.slowMo, opts.protocolTimeout);\n  }\n  /**\n   * @internal\n   */\n  async createBiDiOverCdpBrowser(browserProcess, connection, closeCallback, opts) {\n    // TODO: use other options too.\n    const BiDi = await Promise.resolve().then(() => __importStar(require( /* webpackIgnore: true */'../bidi/bidi.js')));\n    const bidiConnection = await BiDi.connectBidiOverCdp(connection, {\n      acceptInsecureCerts: opts.ignoreHTTPSErrors ?? false\n    });\n    return await BiDi.BidiBrowser.create({\n      connection: bidiConnection,\n      closeCallback,\n      process: browserProcess.nodeProcess,\n      defaultViewport: opts.defaultViewport,\n      ignoreHTTPSErrors: opts.ignoreHTTPSErrors\n    });\n  }\n  /**\n   * @internal\n   */\n  async createBiDiBrowser(browserProcess, closeCallback, opts) {\n    const browserWSEndpoint = (await browserProcess.waitForLineOutput(browsers_1.WEBDRIVER_BIDI_WEBSOCKET_ENDPOINT_REGEX, opts.timeout)) + '/session';\n    const transport = await NodeWebSocketTransport_js_1.NodeWebSocketTransport.create(browserWSEndpoint);\n    const BiDi = await Promise.resolve().then(() => __importStar(require( /* webpackIgnore: true */'../bidi/bidi.js')));\n    const bidiConnection = new BiDi.BidiConnection(browserWSEndpoint, transport, opts.slowMo, opts.protocolTimeout);\n    // TODO: use other options too.\n    return await BiDi.BidiBrowser.create({\n      connection: bidiConnection,\n      closeCallback,\n      process: browserProcess.nodeProcess,\n      defaultViewport: opts.defaultViewport,\n      ignoreHTTPSErrors: opts.ignoreHTTPSErrors\n    });\n  }\n  /**\n   * @internal\n   */\n  getProfilePath() {\n    return (0, path_1.join)(this.puppeteer.configuration.temporaryDirectory ?? (0, os_1.tmpdir)(), `puppeteer_dev_${this.product}_profile-`);\n  }\n  /**\n   * @internal\n   */\n  resolveExecutablePath(headless) {\n    let executablePath = this.puppeteer.configuration.executablePath;\n    if (executablePath) {\n      if (!(0, fs_1.existsSync)(executablePath)) {\n        throw new Error(`Tried to find the browser at the configured path (${executablePath}), but no executable was found.`);\n      }\n      return executablePath;\n    }\n    function productToBrowser(product, headless) {\n      switch (product) {\n        case 'chrome':\n          if (headless === 'shell') {\n            return browsers_1.Browser.CHROMEHEADLESSSHELL;\n          }\n          return browsers_1.Browser.CHROME;\n        case 'firefox':\n          return browsers_1.Browser.FIREFOX;\n      }\n      return browsers_1.Browser.CHROME;\n    }\n    executablePath = (0, browsers_1.computeExecutablePath)({\n      cacheDir: this.puppeteer.defaultDownloadPath,\n      browser: productToBrowser(this.product, headless),\n      buildId: this.puppeteer.browserRevision\n    });\n    if (!(0, fs_1.existsSync)(executablePath)) {\n      if (this.puppeteer.configuration.browserRevision) {\n        throw new Error(`Tried to find the browser at the configured path (${executablePath}) for revision ${this.puppeteer.browserRevision}, but no executable was found.`);\n      }\n      switch (this.product) {\n        case 'chrome':\n          throw new Error(`Could not find Chrome (ver. ${this.puppeteer.browserRevision}). This can occur if either\\n` + ' 1. you did not perform an installation before running the script (e.g. `npx puppeteer browsers install chrome`) or\\n' + ` 2. your cache path is incorrectly configured (which is: ${this.puppeteer.configuration.cacheDirectory}).\\n` + 'For (2), check out our guide on configuring puppeteer at https://pptr.dev/guides/configuration.');\n        case 'firefox':\n          throw new Error(`Could not find Firefox (rev. ${this.puppeteer.browserRevision}). This can occur if either\\n` + ' 1. you did not perform an installation for Firefox before running the script (e.g. `npx puppeteer browsers install firefox`) or\\n' + ` 2. your cache path is incorrectly configured (which is: ${this.puppeteer.configuration.cacheDirectory}).\\n` + 'For (2), check out our guide on configuring puppeteer at https://pptr.dev/guides/configuration.');\n      }\n    }\n    return executablePath;\n  }\n}\nexports.ProductLauncher = ProductLauncher;","map":{"version":3,"names":["fs_1","require","os_1","path_1","browsers_1","rxjs_js_1","Browser_js_1","Connection_js_1","Errors_js_1","util_js_1","NodeWebSocketTransport_js_1","PipeTransport_js_1","ProductLauncher","product","puppeteer","actualBrowserRevision","constructor","launch","options","dumpio","env","process","handleSIGINT","handleSIGTERM","handleSIGHUP","ignoreHTTPSErrors","defaultViewport","DEFAULT_VIEWPORT","slowMo","timeout","waitForInitialPage","protocolTimeout","protocol","launchArgs","computeLaunchArguments","existsSync","executablePath","Error","usePipe","args","includes","onProcessExit","cleanUserDataDir","userDataDir","isTemp","isTempUserDataDir","browserProcess","pipe","onExit","browser","cdpConnection","closing","browserCloseCallback","closeBrowser","createBiDiBrowser","createCdpPipeConnection","createCdpSocketConnection","createBiDiOverCdpBrowser","CdpBrowser","_create","nodeProcess","targetFilter","error","TimeoutError","message","waitForPageTarget","getActualBrowserRevision","hasClosed","debugError","close","firstValueFrom","race","from","timer","map","waitForTarget","t","type","opts","browserWSEndpoint","waitForLineOutput","CDP_WEBSOCKET_ENDPOINT_REGEX","transport","NodeWebSocketTransport","create","Connection","pipeWrite","pipeRead","stdio","PipeTransport","connection","closeCallback","BiDi","Promise","resolve","then","__importStar","bidiConnection","connectBidiOverCdp","acceptInsecureCerts","BidiBrowser","WEBDRIVER_BIDI_WEBSOCKET_ENDPOINT_REGEX","BidiConnection","getProfilePath","join","configuration","temporaryDirectory","tmpdir","resolveExecutablePath","headless","productToBrowser","Browser","CHROMEHEADLESSSHELL","CHROME","FIREFOX","computeExecutablePath","cacheDir","defaultDownloadPath","buildId","browserRevision","cacheDirectory","exports"],"sources":["/Users/carlosgutierrez/Documents/React/spanish/node_modules/puppeteer-core/src/node/ProductLauncher.ts"],"sourcesContent":["/**\n * @license\n * Copyright 2017 Google Inc.\n * SPDX-License-Identifier: Apache-2.0\n */\nimport {existsSync} from 'fs';\nimport {tmpdir} from 'os';\nimport {join} from 'path';\n\nimport {\n  Browser as InstalledBrowser,\n  CDP_WEBSOCKET_ENDPOINT_REGEX,\n  launch,\n  TimeoutError as BrowsersTimeoutError,\n  WEBDRIVER_BIDI_WEBSOCKET_ENDPOINT_REGEX,\n  computeExecutablePath,\n} from '@puppeteer/browsers';\n\nimport {\n  firstValueFrom,\n  from,\n  map,\n  race,\n  timer,\n} from '../../third_party/rxjs/rxjs.js';\nimport type {Browser, BrowserCloseCallback} from '../api/Browser.js';\nimport {CdpBrowser} from '../cdp/Browser.js';\nimport {Connection} from '../cdp/Connection.js';\nimport {TimeoutError} from '../common/Errors.js';\nimport type {Product} from '../common/Product.js';\nimport {debugError, DEFAULT_VIEWPORT} from '../common/util.js';\nimport type {Viewport} from '../common/Viewport.js';\n\nimport type {\n  BrowserLaunchArgumentOptions,\n  ChromeReleaseChannel,\n  PuppeteerNodeLaunchOptions,\n} from './LaunchOptions.js';\nimport {NodeWebSocketTransport as WebSocketTransport} from './NodeWebSocketTransport.js';\nimport {PipeTransport} from './PipeTransport.js';\nimport type {PuppeteerNode} from './PuppeteerNode.js';\n\n/**\n * @internal\n */\nexport interface ResolvedLaunchArgs {\n  isTempUserDataDir: boolean;\n  userDataDir: string;\n  executablePath: string;\n  args: string[];\n}\n\n/**\n * Describes a launcher - a class that is able to create and launch a browser instance.\n *\n * @public\n */\nexport abstract class ProductLauncher {\n  #product: Product;\n\n  /**\n   * @internal\n   */\n  puppeteer: PuppeteerNode;\n\n  /**\n   * @internal\n   */\n  protected actualBrowserRevision?: string;\n\n  /**\n   * @internal\n   */\n  constructor(puppeteer: PuppeteerNode, product: Product) {\n    this.puppeteer = puppeteer;\n    this.#product = product;\n  }\n\n  get product(): Product {\n    return this.#product;\n  }\n\n  async launch(options: PuppeteerNodeLaunchOptions = {}): Promise<Browser> {\n    const {\n      dumpio = false,\n      env = process.env,\n      handleSIGINT = true,\n      handleSIGTERM = true,\n      handleSIGHUP = true,\n      ignoreHTTPSErrors = false,\n      defaultViewport = DEFAULT_VIEWPORT,\n      slowMo = 0,\n      timeout = 30000,\n      waitForInitialPage = true,\n      protocolTimeout,\n      protocol,\n    } = options;\n\n    const launchArgs = await this.computeLaunchArguments(options);\n\n    if (!existsSync(launchArgs.executablePath)) {\n      throw new Error(\n        `Browser was not found at the configured executablePath (${launchArgs.executablePath})`\n      );\n    }\n\n    const usePipe = launchArgs.args.includes('--remote-debugging-pipe');\n\n    const onProcessExit = async () => {\n      await this.cleanUserDataDir(launchArgs.userDataDir, {\n        isTemp: launchArgs.isTempUserDataDir,\n      });\n    };\n\n    const browserProcess = launch({\n      executablePath: launchArgs.executablePath,\n      args: launchArgs.args,\n      handleSIGHUP,\n      handleSIGTERM,\n      handleSIGINT,\n      dumpio,\n      env,\n      pipe: usePipe,\n      onExit: onProcessExit,\n    });\n\n    let browser: Browser;\n    let cdpConnection: Connection;\n    let closing = false;\n\n    const browserCloseCallback: BrowserCloseCallback = async () => {\n      if (closing) {\n        return;\n      }\n      closing = true;\n      await this.closeBrowser(browserProcess, cdpConnection);\n    };\n\n    try {\n      if (this.#product === 'firefox' && protocol === 'webDriverBiDi') {\n        browser = await this.createBiDiBrowser(\n          browserProcess,\n          browserCloseCallback,\n          {\n            timeout,\n            protocolTimeout,\n            slowMo,\n            defaultViewport,\n            ignoreHTTPSErrors,\n          }\n        );\n      } else {\n        if (usePipe) {\n          cdpConnection = await this.createCdpPipeConnection(browserProcess, {\n            timeout,\n            protocolTimeout,\n            slowMo,\n          });\n        } else {\n          cdpConnection = await this.createCdpSocketConnection(browserProcess, {\n            timeout,\n            protocolTimeout,\n            slowMo,\n          });\n        }\n        if (protocol === 'webDriverBiDi') {\n          browser = await this.createBiDiOverCdpBrowser(\n            browserProcess,\n            cdpConnection,\n            browserCloseCallback,\n            {\n              timeout,\n              protocolTimeout,\n              slowMo,\n              defaultViewport,\n              ignoreHTTPSErrors,\n            }\n          );\n        } else {\n          browser = await CdpBrowser._create(\n            this.product,\n            cdpConnection,\n            [],\n            ignoreHTTPSErrors,\n            defaultViewport,\n            browserProcess.nodeProcess,\n            browserCloseCallback,\n            options.targetFilter\n          );\n        }\n      }\n    } catch (error) {\n      void browserCloseCallback();\n      if (error instanceof BrowsersTimeoutError) {\n        throw new TimeoutError(error.message);\n      }\n      throw error;\n    }\n\n    if (waitForInitialPage && protocol !== 'webDriverBiDi') {\n      await this.waitForPageTarget(browser, timeout);\n    }\n\n    return browser;\n  }\n\n  abstract executablePath(channel?: ChromeReleaseChannel): string;\n\n  abstract defaultArgs(object: BrowserLaunchArgumentOptions): string[];\n\n  /**\n   * Set only for Firefox, after the launcher resolves the `latest` revision to\n   * the actual revision.\n   * @internal\n   */\n  getActualBrowserRevision(): string | undefined {\n    return this.actualBrowserRevision;\n  }\n\n  /**\n   * @internal\n   */\n  protected abstract computeLaunchArguments(\n    options: PuppeteerNodeLaunchOptions\n  ): Promise<ResolvedLaunchArgs>;\n\n  /**\n   * @internal\n   */\n  protected abstract cleanUserDataDir(\n    path: string,\n    opts: {isTemp: boolean}\n  ): Promise<void>;\n\n  /**\n   * @internal\n   */\n  protected async closeBrowser(\n    browserProcess: ReturnType<typeof launch>,\n    cdpConnection?: Connection\n  ): Promise<void> {\n    if (cdpConnection) {\n      // Attempt to close the browser gracefully\n      try {\n        await cdpConnection.closeBrowser();\n        await browserProcess.hasClosed();\n      } catch (error) {\n        debugError(error);\n        await browserProcess.close();\n      }\n    } else {\n      // Wait for a possible graceful shutdown.\n      await firstValueFrom(\n        race(\n          from(browserProcess.hasClosed()),\n          timer(5000).pipe(\n            map(() => {\n              return from(browserProcess.close());\n            })\n          )\n        )\n      );\n    }\n  }\n\n  /**\n   * @internal\n   */\n  protected async waitForPageTarget(\n    browser: Browser,\n    timeout: number\n  ): Promise<void> {\n    try {\n      await browser.waitForTarget(\n        t => {\n          return t.type() === 'page';\n        },\n        {timeout}\n      );\n    } catch (error) {\n      await browser.close();\n      throw error;\n    }\n  }\n\n  /**\n   * @internal\n   */\n  protected async createCdpSocketConnection(\n    browserProcess: ReturnType<typeof launch>,\n    opts: {timeout: number; protocolTimeout: number | undefined; slowMo: number}\n  ): Promise<Connection> {\n    const browserWSEndpoint = await browserProcess.waitForLineOutput(\n      CDP_WEBSOCKET_ENDPOINT_REGEX,\n      opts.timeout\n    );\n    const transport = await WebSocketTransport.create(browserWSEndpoint);\n    return new Connection(\n      browserWSEndpoint,\n      transport,\n      opts.slowMo,\n      opts.protocolTimeout\n    );\n  }\n\n  /**\n   * @internal\n   */\n  protected async createCdpPipeConnection(\n    browserProcess: ReturnType<typeof launch>,\n    opts: {timeout: number; protocolTimeout: number | undefined; slowMo: number}\n  ): Promise<Connection> {\n    // stdio was assigned during start(), and the 'pipe' option there adds the\n    // 4th and 5th items to stdio array\n    const {3: pipeWrite, 4: pipeRead} = browserProcess.nodeProcess.stdio;\n    const transport = new PipeTransport(\n      pipeWrite as NodeJS.WritableStream,\n      pipeRead as NodeJS.ReadableStream\n    );\n    return new Connection('', transport, opts.slowMo, opts.protocolTimeout);\n  }\n\n  /**\n   * @internal\n   */\n  protected async createBiDiOverCdpBrowser(\n    browserProcess: ReturnType<typeof launch>,\n    connection: Connection,\n    closeCallback: BrowserCloseCallback,\n    opts: {\n      timeout: number;\n      protocolTimeout: number | undefined;\n      slowMo: number;\n      defaultViewport: Viewport | null;\n      ignoreHTTPSErrors?: boolean;\n    }\n  ): Promise<Browser> {\n    // TODO: use other options too.\n    const BiDi = await import(/* webpackIgnore: true */ '../bidi/bidi.js');\n    const bidiConnection = await BiDi.connectBidiOverCdp(connection, {\n      acceptInsecureCerts: opts.ignoreHTTPSErrors ?? false,\n    });\n    return await BiDi.BidiBrowser.create({\n      connection: bidiConnection,\n      closeCallback,\n      process: browserProcess.nodeProcess,\n      defaultViewport: opts.defaultViewport,\n      ignoreHTTPSErrors: opts.ignoreHTTPSErrors,\n    });\n  }\n\n  /**\n   * @internal\n   */\n  protected async createBiDiBrowser(\n    browserProcess: ReturnType<typeof launch>,\n    closeCallback: BrowserCloseCallback,\n    opts: {\n      timeout: number;\n      protocolTimeout: number | undefined;\n      slowMo: number;\n      defaultViewport: Viewport | null;\n      ignoreHTTPSErrors?: boolean;\n    }\n  ): Promise<Browser> {\n    const browserWSEndpoint =\n      (await browserProcess.waitForLineOutput(\n        WEBDRIVER_BIDI_WEBSOCKET_ENDPOINT_REGEX,\n        opts.timeout\n      )) + '/session';\n    const transport = await WebSocketTransport.create(browserWSEndpoint);\n    const BiDi = await import(/* webpackIgnore: true */ '../bidi/bidi.js');\n    const bidiConnection = new BiDi.BidiConnection(\n      browserWSEndpoint,\n      transport,\n      opts.slowMo,\n      opts.protocolTimeout\n    );\n    // TODO: use other options too.\n    return await BiDi.BidiBrowser.create({\n      connection: bidiConnection,\n      closeCallback,\n      process: browserProcess.nodeProcess,\n      defaultViewport: opts.defaultViewport,\n      ignoreHTTPSErrors: opts.ignoreHTTPSErrors,\n    });\n  }\n\n  /**\n   * @internal\n   */\n  protected getProfilePath(): string {\n    return join(\n      this.puppeteer.configuration.temporaryDirectory ?? tmpdir(),\n      `puppeteer_dev_${this.product}_profile-`\n    );\n  }\n\n  /**\n   * @internal\n   */\n  protected resolveExecutablePath(headless?: boolean | 'shell'): string {\n    let executablePath = this.puppeteer.configuration.executablePath;\n    if (executablePath) {\n      if (!existsSync(executablePath)) {\n        throw new Error(\n          `Tried to find the browser at the configured path (${executablePath}), but no executable was found.`\n        );\n      }\n      return executablePath;\n    }\n\n    function productToBrowser(product?: Product, headless?: boolean | 'shell') {\n      switch (product) {\n        case 'chrome':\n          if (headless === 'shell') {\n            return InstalledBrowser.CHROMEHEADLESSSHELL;\n          }\n          return InstalledBrowser.CHROME;\n        case 'firefox':\n          return InstalledBrowser.FIREFOX;\n      }\n      return InstalledBrowser.CHROME;\n    }\n\n    executablePath = computeExecutablePath({\n      cacheDir: this.puppeteer.defaultDownloadPath!,\n      browser: productToBrowser(this.product, headless),\n      buildId: this.puppeteer.browserRevision,\n    });\n\n    if (!existsSync(executablePath)) {\n      if (this.puppeteer.configuration.browserRevision) {\n        throw new Error(\n          `Tried to find the browser at the configured path (${executablePath}) for revision ${this.puppeteer.browserRevision}, but no executable was found.`\n        );\n      }\n      switch (this.product) {\n        case 'chrome':\n          throw new Error(\n            `Could not find Chrome (ver. ${this.puppeteer.browserRevision}). This can occur if either\\n` +\n              ' 1. you did not perform an installation before running the script (e.g. `npx puppeteer browsers install chrome`) or\\n' +\n              ` 2. your cache path is incorrectly configured (which is: ${this.puppeteer.configuration.cacheDirectory}).\\n` +\n              'For (2), check out our guide on configuring puppeteer at https://pptr.dev/guides/configuration.'\n          );\n        case 'firefox':\n          throw new Error(\n            `Could not find Firefox (rev. ${this.puppeteer.browserRevision}). This can occur if either\\n` +\n              ' 1. you did not perform an installation for Firefox before running the script (e.g. `npx puppeteer browsers install firefox`) or\\n' +\n              ` 2. your cache path is incorrectly configured (which is: ${this.puppeteer.configuration.cacheDirectory}).\\n` +\n              'For (2), check out our guide on configuring puppeteer at https://pptr.dev/guides/configuration.'\n          );\n      }\n    }\n    return executablePath;\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}